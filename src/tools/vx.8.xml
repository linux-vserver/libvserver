<?xml version="1.0" standalone='no'?>
<!DOCTYPE manpage SYSTEM "http://masqmail.cx/xmltoman/xmltoman.dtd">
<?xml-stylesheet type="text/xsl" href="http://masqmail.cx/xmltoman/xmltoman.xsl" ?>

<manpage name="vx" section="8" desc="Virtual Context Setup">

<synopsis>
<cmd>vx -create      <arg>xid</arg> [<arg>list</arg>] [-- <arg>program</arg> <arg>args</arg>*]</cmd>
<cmd>vx -migrate     <arg>xid</arg> -- <arg>program</arg> <arg>args</arg>*</cmd>
<cmd>vx -login       <arg>xid</arg> [-- <arg>program</arg> <arg>args</arg>*]</cmd>
<cmd>vx -set-bcaps   <arg>xid</arg> <arg>list</arg></cmd>
<cmd>vx -set-ccaps   <arg>xid</arg> <arg>list</arg></cmd>
<cmd>vx -set-flags   <arg>xid</arg> <arg>list</arg></cmd>
<cmd>vx -set-limit   <arg>xid</arg> <arg>type</arg>=<arg>min</arg>,<arg>soft</arg>,<arg>hard</arg>*</cmd>
<cmd>vx -set-sched   <arg>xid</arg> <arg>type</arg>=<arg>value</arg>*</cmd>
<cmd>vx -set-vhi     <arg>xid</arg> <arg>type</arg>=<arg>value</arg>*</cmd>
<cmd>vx -get-bcaps   <arg>xid</arg></cmd>
<cmd>vx -get-ccaps   <arg>xid</arg></cmd>
<cmd>vx -get-flags   <arg>xid</arg></cmd>
<cmd>vx -get-limit   <arg>xid</arg> <arg>type</arg>*</cmd>
<cmd>vx -get-vhi     <arg>xid</arg> <arg>type</arg>*</cmd>
<cmd>vx -kill        <arg>xid</arg> [<arg>pid</arg> <arg>sig</arg>]</cmd>
<cmd>vx -wait        <arg>xid</arg></cmd>
<cmd>vx -reset-limit <arg>xid</arg></cmd>
</synopsis>

<description>
<p>The purpose of this "Context" is to hide all processes outside of its scope,
and prohibit any unwanted interaction between a process inside the context and a
process belonging to another context.</p>
<p>This separation requires the extension of some existing data structures in
order for them to become aware of contexts and to differentiate between
identical uids used in different virtual servers.</p>
<p>It also requires the definition of a default context that is used when the
host system is booted, and to work around the issues resulting from some false
assumptions made by some user-space tools (like pstree) that the init process
has to exist and to be running under id '1'.</p>
<p>To simplify administration, the Host Context isn't treated any differently
than any other context as far as process isolation is concerned. To allow for
process overview, a special Spectator context has been defined to peek at all
processes at once.</p>
</description>

<options>
<option>
<p><opt>-create</opt></p>
<optdesc><p>Create a new context with id <arg>xid</arg> using optional flags in
<arg>list</arg> and optionally run <arg>program</arg> in the new context.</p></optdesc>
</option>

<option>
<p><opt>-migrate</opt></p>
<optdesc><p>Migrate to context <arg>xid</arg> and execute <arg>program</arg>.</p></optdesc>
</option>

<option>
<p><opt>-login</opt></p>
<optdesc><p>Migrate to context <arg>xid</arg> and execute <arg>program</arg>
using a new pseudo terminal.</p></optdesc>
</option>

<option>
<p><opt>-set-bcaps</opt></p>
<optdesc><p>Set system capabilities in <arg>list</arg> for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-set-ccaps</opt></p>
<optdesc><p>Set context capabilities in <arg>list</arg> for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-set-flags</opt></p>
<optdesc><p>Set context flags in <arg>list</arg> for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-set-limit</opt></p>
<optdesc><p>Set <arg>min</arg>, <arg>soft</arg> and <arg>hard</arg> limit for
<arg>type</arg> and context <arg>xid</arg>. See below for valid limit types.</p></optdesc>
</option>

<option>
<p><opt>-set-sched</opt></p>
<optdesc><p>Set token bucket scheduler for context <arg>xid</arg>
using <arg>value</arg>. See below for valid scheduler types.</p></optdesc>
</option>

<option>
<p><opt>-set-vhi</opt></p>
<optdesc><p>Set virtual host information (UTS/uname) for context <arg>xid</arg>
using <arg>value</arg>. See below for valid VHI types.</p></optdesc>
</option>

<option>
<p><opt>-get-bcaps</opt></p>
<optdesc><p>Get system capabilities for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-get-ccaps</opt></p>
<optdesc><p>Get context capabilities for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-get-flags</opt></p>
<optdesc><p>Get context flags for context
<arg>xid</arg>. See below for valid capabilities.</p></optdesc>
</option>

<option>
<p><opt>-get-limit</opt></p>
<optdesc><p>Get limit for <arg>type</arg> and context <arg>xid</arg>. See below
for valid limit types.</p></optdesc>
</option>

<option>
<p><opt>-get-vhi</opt></p>
<optdesc><p>Get virtual host information (UTS/uname) for context <arg>xid</arg>.
See below for valid VHI types.</p></optdesc>
</option>

<option>
<p><opt>-kill</opt></p>
<optdesc><p>Kill process(es) in context <arg>xid</arg> using optional process id
<arg>pid</arg> and signal number <arg>sig</arg>. Default signal number is 9.</p></optdesc>
</option>

<option>
<p><opt>-wait</opt></p>
<optdesc><p>Wait until context has died.</p></optdesc>
</option>

<option>
<p><opt>-reset-limit</opt></p>
<optdesc><p>Reset limit accounting for context <arg>xid</arg>.</p></optdesc>
</option>

</options>

<section name="Valid System Capabilities">
See <manref name="capabilities" section="7"/>.
</section>

<section name="Valid context capabilities">
<p>SET_UTSNAME - allow <manref name="setdomainname" section="2"/> and
<manref name="sethostname" section="2"/></p>
<p>SET_RLIMIT - allow <manref name="setrlimit" section="2"/></p>
<p>RAW_ICMP - allow raw ICMP sockets</p>
<p>SYSLOG - allow <manref name="syslog" section="2"/></p>
<p>SECURE_MOUNT - allow secure <manref name="mount" section="2"/></p>
<p>SECURE_REMOUNT - allow secure remount</p>
<p>BINARY_MOUNT - allow binary/network mounts</p>
<p>QUOTA_CTL - allow quota ioctl</p>
</section>

<section name="Valid Context Flags">
<p>INFO_LOCK - Prohibit further context switches (legacy)</p>
<p>INFO_SCHED - Account all processes as one (legacy)</p>
<p>INFO_NPROC - Apply process limits to context (legacy)</p>
<p>INFO_PRIVATE - Context cannot be entered (legacy)</p>
<p>INFO_INIT - Show a fake init process</p>
<p>INFO_HIDE - Hide context information in task status</p>
<p>INFO_ULIMIT - Apply ulimits to context (legacy)</p>
<p>INFO_NSPACE - Use private namespace (legacy)</p>
<p>SCHED_HARD - Enable hard scheduler</p>
<p>SCHED_PRIO - Enable priority scheduler</p>
<p>SCHED_PAUSE - Pause context (unschedule)</p>
<p>VIRT_MEM - Virtualize memory information</p>
<p>VIRT_UPTIME - Virtualize uptime information</p>
<p>VIRT_CPU - Virtualize cpu usage information</p>
<p>VIRT_LOAD - Virtualize load average information</p>
<p>VIRT_TIME - Allow per guest time offsets</p>
<p>HIDE_MOUNT - Hide entries in /proc/$pid/mounts</p>
<p>HIDE_NETIF - Hide foreign network interfaces</p>
<p>STATE_SETUP - Context is in setup state</p>
<p>STATE_INIT - Context is in init state</p>
<p>SC_HELPER - Context state change helper</p>
<p>REBOOT_KILL - Kill all processes on <manref name="reboot" section="2"/></p>
<p>PERSISTENT - Make context persistent</p>
<p>FORK_RSS - Block fork when over RSS</p>
<p>PROLIFIC - Allow context to create new contexts</p>
<p>IGNEG_NICE - Ignore priority raise</p>
</section>

<section name="Valid Limit Types">
<p>CPU</p>
<p>FSIZE</p>
<p>DATA</p>
<p>STACK</p>
<p>CORE</p>
<p>RSS</p>
<p>NPROC</p>
<p>NOFILE</p>
<p>MEMLOCK</p>
<p>AS</p>
<p>LOCKS</p>
<p>NSOCK</p>
<p>OPENFD</p>
<p>ANON</p>
<p>SHMEM</p>
<p>SEMARY</p>
<p>NSEMS</p>
<p>DENTRY</p>
</section>

<section name="Valid Scheduler Types">
<p>FILL_RATE</p>
<p>FILL_RATE2</p>
<p>INTERVAL</p>
<p>INTERVAL2</p>
<p>TOKENS</p>
<p>TOKENS_MIN</p>
<p>TOKENS_MAX</p>
<p>PRIO_BIAS</p>
<p>IDLE_TIME</p>
<p>FORCE</p>
<p>CPU_ID</p>
<p>BUCKET_ID</p>
</section>

<section name="Valid VHI Types">
<p>CONTEXT</p>
<p>SYSNAME</p>
<p>NODENAME</p>
<p>RELEASE</p>
<p>VERSION</p>
<p>MACHINE</p>
<p>DOMAINNAME</p>
</section>

<section name="Author">
<p>vx was written by Benedikt Boehm &lt;hollow@gentoo.org&gt;</p>
<p>You will find the newest version of dx in the libvserver package at
<url href="http://linux-vserver.org"/>. There is also a mailing list,
you will find information about it at Linux-VServer main site.</p>
</section>

<section name="Bugs">
<p>You should report them to the mailing list.</p>
</section>

<seealso>
<p>
<manref name="dx" section="8" href="dx.8.html"/>,
<manref name="ix" section="8" href="ix.8.html"/>,
<manref name="ns" section="8" href="ns.8.html"/>,
<manref name="nx" section="8" href="nx.8.html"/>,
<manref name="vr" section="8" href="vr.8.html"/>
</p>
</seealso>

</manpage>
